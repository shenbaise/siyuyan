<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<style type="text/css">
<!--
body {
margin-top: 0px;
margin-bottom: 0px;
margin-left: 0px;
margin-right: 0px;
}
-->
</style>
</head>
<body scroll="no"> 
<SCRIPT> 
/*
地址参数说明示例：file:///E:/player/player.html?flash&big.swf&300&600&paramString&embedString
参数以文件地址加“？”后的字符串传递，以“&”参数必须经过URL编码
第一个参数表示文件类型：flash,media,real,apple分别代表4种不同播放器，如果填none则由文件名后缀决定
第二个参数表示文件位置：这个参数必须要有
第三个表示播放宽度：默认填none为最大
第四个表示播放高度：默认填none为最大
第五个表示播放器param参数：IE浏览器专用，参数如果不为none会替代默认值，参数内容为一个或者多个参数字串组合，例：
“<param NAME='AutoStart' VALUE='-1'>”整个字串的URL编码
第六个表示播放器embed参数：其它浏览器用，参数如果不为none会替代默认值，参数内容为一个或者多个参数字串组合，例：
“ autostart='true'” 整个字串的URL编码
后面4个参数如果采用默认值，可不填例：file:///E:/player/player.html?none&big.swf
none&ftp://dy131.com:6vdy.com@ftp1.66e.cc:2125/【最新电影www.66e.cc】墨水心BD国语中字1024高清.rmvb
这个地址将通过判定swf后缀，采用FLASH 播放器
*/
var tmpArray=location.href.split("?");   
var pramArray;
var hasPram=0;
if (tmpArray.length==2){
   pramArray=tmpArray[1].split("&");
   if (pramArray.length>0){
    hasPram=pramArray.length;
   }
}
var fileType=""
var fileUrl="";
var widthVal="100%";
var heightValue="100%";
var paramString="";
var embedString="";
if (hasPram>0){ 
   if (decodeURI(pramArray[0])!="none"){
    fileType=decodeURI(pramArray[0]);  
   }  
   if (hasPram>1){  
    fileUrl=decodeURI(pramArray[1]);
   }  
   if (hasPram>2){
    if (decodeURI(pramArray[2])!="none"){
     widthVal=decodeURI(pramArray[2]);  
    }
   } 
   if (hasPram>3){
    if (decodeURI(pramArray[3])!="none"){
     heightValue=decodeURI(pramArray[3]); 
    } 
   } 
   if (hasPram>4){
    if (decodeURI(pramArray[4])!="none"){
     paramString=decodeURI(pramArray[4]);  
    }   
   } 
   if (hasPram>5){
    if (decodeURI(pramArray[5])!="none"){
     embedString=decodeURI(pramArray[5]);  
    }   
   }   
   if (fileType=="flash"){
    flashPlay(fileUrl,widthVal,heightValue,paramString);  
   }else if (fileType=="media"){
    mediaPlay(fileUrl,widthVal,heightValue,paramString,embedString)
   }else if (fileType=="real"){
    realPlay(fileUrl,widthVal,heightValue,paramString,embedString)
   }else if (fileType=="apple"){
    applePlay(fileUrl,widthVal,heightValue,paramString,embedString)
   }else{
    selectPlayer(fileUrl);
   }
}else{
   document.write("No param!");
}
//FLASH 播放器
function flashPlay(fileUrl,widthVale,heightValue,paramString){
   var defaultPram="";
   var writeString="";
   writeString+=" <object type='application/x-shockwave-flash' ";
   writeString+=" data='"+fileUrl+"' ";
   writeString+=" width='"+widthVale+"' height='"+heightValue+"' ";
   writeString+=" id='VideoPlayback'>";
   writeString+="<param name='movie' value='"+fileUrl+"' />";
  
   defaultPram+="<param name='allowScriptAcess' value='sameDomain' />";
   defaultPram+="<param name='quality' value='best' />";
   defaultPram+="<param name='bgcolor' value='#FFFFFF' />"; 
   defaultPram+="<param name='scale' value='Exactfit' />";
   defaultPram+="<param name='salign' value='TL' />";
   defaultPram+="<param name='FlashVars' value='playerMode=embedded' />";
  
   if (paramString==""){
    paramString=defaultPram;
   }
   writeString+=paramString;
   writeString+="</object>";
   document.write(writeString);
}
//MEDIA 播放器
function mediaPlay(fileUrl,widthVale,heightValue,paramString,embedString){
   var defaultPram="";
   var defaultEmbed="";
   var writeString="";
   writeString+=" <object classid='CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6'";
   writeString+=" width='"+widthVale+"' height='"+heightValue+"' ";
   writeString+=" > ";
   writeString+=" <param NAME='url' VALUE='"+fileUrl+"'>";  
  
   defaultPram+=" <param NAME='AutoStart' VALUE='-1'>";
   defaultPram+=" <param name='enabled' value='-1'>";
   defaultPram+=" <param NAME='EnableContextMenu' VALUE='-1'>";  
   defaultPram+=" <param NAME='PlayCount' VALUE='99999999'>";
   defaultPram+=" <param name='stretchToFit' value='-1'>";
   defaultPram+=" <param name='uiMode' value='None'>   ";
   defaultPram+=" <param name='windowlessVideo' value='0'>";
   defaultPram+=" <param name='fullScreen' value='0'>";
   if (paramString==""){
    paramString=defaultPram;
   }
   writeString+=paramString;
  
   writeString+="<embed src='"+fileUrl+"' ";
   writeString+=" width='"+widthVale+"' height='"+heightValue+"' ";
  
   defaultEmbed+=" autostart='true' ";
   defaultEmbed+=" showcontrols='0' ";
   defaultEmbed+=" loop='true' ";
   defaultEmbed+=" EnableContextMenu='0' ";

   defaultEmbed+=" type='application/x-mplayer2' ";
  
   if (embedString==""){
    embedString=defaultEmbed;
   }
   writeString+=embedString;
  
   writeString+=" /> ";
  
  
   writeString+="</object>"; 
   document.write(writeString); 
}
//REAL 播放器
function realPlay(fileUrl,widthVale,heightValue,paramString,embedString){
   var defaultPram="";
   var defaultEmbed="";
   var writeString="";
   writeString+=" <object classid='clsid:CFCDAA03-8BE4-11cf-B84B-0020AFBBCCFA' ";
   writeString+=" width='"+widthVale+"' height='"+heightValue+"' ";
   writeString+=" id='VideoPlay'>";
   writeString+=" <param name='src' value='"+fileUrl+"' />";
  
   //defaultPram+=" <param name='controls' value='Imagewindow,ControlPanel,StatusBar' /> ";
   defaultPram+=" <param name='controls' value='Imagewindow' /> ";
   defaultPram+=" <param name='console' value='clip1' /> ";
   defaultPram+=" <param name='autostart' value='true' /> ";
  
   if (paramString==""){
    paramString=defaultPram;
   }
   writeString+=paramString;
  
    
   writeString+="<embed src='"+fileUrl+"' ";
   writeString+=" width='"+widthVale+"' height='"+heightValue+"' ";
  
   defaultEmbed+=" autostart='true' ";
   defaultEmbed+=" controls='Imagewindow' ";
   defaultEmbed+=" loop='true' ";
   defaultEmbed+=" type='audio/x-pn-realaudio-plugin' ";
  
   if (embedString==""){
    embedString=defaultEmbed;
   }
   writeString+=embedString;
  
   writeString+=" /> ";
    
   writeString+="</object>";
   document.write(writeString);
}
//QUICK TIME 播放器
function applePlay(fileUrl,widthVale,heightValue,paramString,embedString){
   var defaultPram="";
   var defaultEmbed="";
   var writeString="";
   writeString+=" <object CLASSID='clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B' ";
   writeString+=" width='"+widthVale+"' height='"+heightValue+"' ";
   writeString+=" id='VideoPlay' CODEBASE='http://www.apple.com/qtactivex/qtplugin.cab'> ";
   writeString+="<param name='src' value='"+fileUrl+"'>   ";
  
   defaultPram+=" <param name='autoplay' value='true'> ";
   defaultPram+=" <param name='controller' value='false'> ";
   defaultPram+=" <param name='loop' value='true'>";
   defaultPram+=" <param name='type' value='video/quicktime'> ";
  
   if (paramString==""){
    paramString=defaultPram;
   }
   writeString+=paramString;
    
  
   writeString+="<embed src='"+fileUrl+"' ";
   writeString+=" width='"+widthVale+"' height='"+heightValue+"' ";
  
   defaultEmbed+=" autoplay='true' ";
   defaultEmbed+=" controller='false' ";
   defaultEmbed+=" loop='true' ";
   defaultEmbed+=" type='video/quicktime' ";
   defaultEmbed+=" pluginspage='http://www.apple.com/quicktime/download/' ";
  
   if (embedString==""){
    embedString=defaultEmbed;
   }
   writeString+=embedString;
  
   writeString+=" /> ";
   writeString+="</object>";
   document.write(writeString);
   //alert(writeString);
}

//选择播放器
//selectPlayer("aaa.txt");
function selectPlayer(fileUrl){
   var dotIndex;
   var fileTail="";
   var flashString=".swf.";
   var mediaString=".asf.asx.wpl.wm.wmx.wmd.wmz.wma.wax.wmv.wvx.";
   var realString=".rt.ra.rm.rmvb.rp.rv.mpg.mpeg.avi.wav.";
   var appleString=".mov.qt.mqv.";
  
   dotIndex=fileUrl.indexOf(".");
   if (dotIndex>0){
    fileTail=fileUrl.substr(dotIndex).toLowerCase();
   }
   //alert(dotIndex+"---"+fileTail);
   if (flashString.indexOf(fileTail)>=0){
    flashPlay(fileUrl,widthVal,heightValue,paramString);  
   }else if (mediaString.indexOf(fileTail)>=0){
    mediaPlay(fileUrl,widthVal,heightValue,paramString,embedString)
   }else if (realString.indexOf(fileTail)>=0){
    realPlay(fileUrl,widthVal,heightValue,paramString,embedString)
   }else if (appleString.indexOf(fileTail)>=0){
    applePlay(fileUrl,widthVal,heightValue,paramString,embedString)
   }else{
    realPlay(fileUrl,widthVal,heightValue,paramString,embedString)
   }
}
</SCRIPT>
</body>
</html>