<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<style type="text/css">
<!--
body {
	margin-top: 0px;
	margin-bottom: 0px;
	margin-left: 0px;
	margin-right: 0px;
}
-->
</style>
</head>
<body scroll="no">
	<SCRIPT> 
/*
��ַ����˵��ʾ��file:///E:/player/player.html?flash&big.swf&300&600&paramString&embedString
�������ļ���ַ�ӡ���������ַ��ݣ��ԡ�&��������뾭��URL����
��һ�������ʾ�ļ����ͣ�flash,media,real,apple�ֱ���4�ֲ�ͬ�������������none�����ļ����׺����
�ڶ��������ʾ�ļ�λ�ã�����������Ҫ��
�������ʾ���ſ�ȣ�Ĭ����noneΪ���
���ĸ���ʾ���Ÿ߶ȣ�Ĭ����noneΪ���
�������ʾ������param����IE�����ר�ã��������Ϊnone�����Ĭ��ֵ����������Ϊһ�����߶�������ִ���ϣ���
��<param NAME='AutoStart' VALUE='-1'>������ִ���URL����
�������ʾ������embed��������������ã��������Ϊnone�����Ĭ��ֵ����������Ϊһ�����߶�������ִ���ϣ���
�� autostart='true'�� ����ִ���URL����
����4������������Ĭ��ֵ���ɲ�����file:///E:/player/player.html?none&big.swf
none&ftp://dy131.com:6vdy.com@ftp1.66e.cc:2125/�����µ�Ӱwww.66e.cc��īˮ��BD��������1024����.rmvb
�����ַ��ͨ���ж�swf��׺������FLASH ������
*/
var tmpArray=location.href.split("?");   
var pramArray;
var hasPram=0;
if (tmpArray.length==2){
   pramArray=tmpArray[1].split("&");
   if (pramArray.length>0){
    hasPram=pramArray.length;
   }
}
var fileType=""
var fileUrl="";
var widthVal="100%";
var heightValue="100%";
var paramString="";
var embedString="";
if (hasPram>0){ 
   if (decodeURI(pramArray[0])!="none"){
    fileType=decodeURI(pramArray[0]);  
   }  
   if (hasPram>1){  
    fileUrl=decodeURI(pramArray[1]);
   }  
   if (hasPram>2){
    if (decodeURI(pramArray[2])!="none"){
     widthVal=decodeURI(pramArray[2]);  
    }
   } 
   if (hasPram>3){
    if (decodeURI(pramArray[3])!="none"){
     heightValue=decodeURI(pramArray[3]); 
    } 
   } 
   if (hasPram>4){
    if (decodeURI(pramArray[4])!="none"){
     paramString=decodeURI(pramArray[4]);  
    }   
   } 
   if (hasPram>5){
    if (decodeURI(pramArray[5])!="none"){
     embedString=decodeURI(pramArray[5]);  
    }   
   }   
   if (fileType=="flash"){
    flashPlay(fileUrl,widthVal,heightValue,paramString);  
   }else if (fileType=="media"){
    mediaPlay(fileUrl,widthVal,heightValue,paramString,embedString)
   }else if (fileType=="real"){
    realPlay(fileUrl,widthVal,heightValue,paramString,embedString)
   }else if (fileType=="apple"){
    applePlay(fileUrl,widthVal,heightValue,paramString,embedString)
   }else{
    selectPlayer(fileUrl);
   }
}else{
   document.write("No param!");
}
//FLASH ������
function flashPlay(fileUrl,widthVale,heightValue,paramString){
   var defaultPram="";
   var writeString="";
   writeString+=" <object type='application/x-shockwave-flash' ";
   writeString+=" data='"+fileUrl+"' ";
   writeString+=" width='"+widthVale+"' height='"+heightValue+"' ";
   writeString+=" id='VideoPlayback'>";
   writeString+="<param name='movie' value='"+fileUrl+"' />";
  
   defaultPram+="<param name='allowScriptAcess' value='sameDomain' />";
   defaultPram+="<param name='quality' value='best' />";
   defaultPram+="<param name='bgcolor' value='#FFFFFF' />"; 
   defaultPram+="<param name='scale' value='Exactfit' />";
   defaultPram+="<param name='salign' value='TL' />";
   defaultPram+="<param name='FlashVars' value='playerMode=embedded' />";
  
   if (paramString==""){
    paramString=defaultPram;
   }
   writeString+=paramString;
   writeString+="</object>";
   document.write(writeString);
}
//MEDIA ������
function mediaPlay(fileUrl,widthVale,heightValue,paramString,embedString){
   var defaultPram="";
   var defaultEmbed="";
   var writeString="";
   writeString+=" <object classid='CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6'";
   writeString+=" width='"+widthVale+"' height='"+heightValue+"' ";
   writeString+=" > ";
   writeString+=" <param NAME='url' VALUE='"+fileUrl+"'>";  
  
   defaultPram+=" <param NAME='AutoStart' VALUE='-1'>";
   defaultPram+=" <param name='enabled' value='-1'>";
   defaultPram+=" <param NAME='EnableContextMenu' VALUE='-1'>";  
   defaultPram+=" <param NAME='PlayCount' VALUE='99999999'>";
   defaultPram+=" <param name='stretchToFit' value='-1'>";
   defaultPram+=" <param name='uiMode' value='None'>   ";
   defaultPram+=" <param name='windowlessVideo' value='0'>";
   defaultPram+=" <param name='fullScreen' value='0'>";
   if (paramString==""){
    paramString=defaultPram;
   }
   writeString+=paramString;
  
   writeString+="<embed src='"+fileUrl+"' ";
   writeString+=" width='"+widthVale+"' height='"+heightValue+"' ";
  
   defaultEmbed+=" autostart='true' ";
   defaultEmbed+=" showcontrols='0' ";
   defaultEmbed+=" loop='true' ";
   defaultEmbed+=" EnableContextMenu='0' ";

   defaultEmbed+=" type='application/x-mplayer2' ";
  
   if (embedString==""){
    embedString=defaultEmbed;
   }
   writeString+=embedString;
  
   writeString+=" /> ";
  
  
   writeString+="</object>"; 
   document.write(writeString); 
}
//REAL ������
function realPlay(fileUrl,widthVale,heightValue,paramString,embedString){
   var defaultPram="";
   var defaultEmbed="";
   var writeString="";
   writeString+=" <object classid='clsid:CFCDAA03-8BE4-11cf-B84B-0020AFBBCCFA' ";
   writeString+=" width='"+widthVale+"' height='"+heightValue+"' ";
   writeString+=" id='VideoPlay'>";
   writeString+=" <param name='src' value='"+fileUrl+"' />";
  
   //defaultPram+=" <param name='controls' value='Imagewindow,ControlPanel,StatusBar' /> ";
   defaultPram+=" <param name='controls' value='Imagewindow' /> ";
   defaultPram+=" <param name='console' value='clip1' /> ";
   defaultPram+=" <param name='autostart' value='true' /> ";
  
   if (paramString==""){
    paramString=defaultPram;
   }
   writeString+=paramString;
  
    
   writeString+="<embed src='"+fileUrl+"' ";
   writeString+=" width='"+widthVale+"' height='"+heightValue+"' ";
  
   defaultEmbed+=" autostart='true' ";
   defaultEmbed+=" controls='Imagewindow' ";
   defaultEmbed+=" loop='true' ";
   defaultEmbed+=" type='audio/x-pn-realaudio-plugin' ";
  
   if (embedString==""){
    embedString=defaultEmbed;
   }
   writeString+=embedString;
  
   writeString+=" /> ";
    
   writeString+="</object>";
   document.write(writeString);
}
//QUICK TIME ������
function applePlay(fileUrl,widthVale,heightValue,paramString,embedString){
   var defaultPram="";
   var defaultEmbed="";
   var writeString="";
   writeString+=" <object CLASSID='clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B' ";
   writeString+=" width='"+widthVale+"' height='"+heightValue+"' ";
   writeString+=" id='VideoPlay' CODEBASE='http://www.apple.com/qtactivex/qtplugin.cab'> ";
   writeString+="<param name='src' value='"+fileUrl+"'>   ";
  
   defaultPram+=" <param name='autoplay' value='true'> ";
   defaultPram+=" <param name='controller' value='false'> ";
   defaultPram+=" <param name='loop' value='true'>";
   defaultPram+=" <param name='type' value='video/quicktime'> ";
  
   if (paramString==""){
    paramString=defaultPram;
   }
   writeString+=paramString;
    
  
   writeString+="<embed src='"+fileUrl+"' ";
   writeString+=" width='"+widthVale+"' height='"+heightValue+"' ";
  
   defaultEmbed+=" autoplay='true' ";
   defaultEmbed+=" controller='false' ";
   defaultEmbed+=" loop='true' ";
   defaultEmbed+=" type='video/quicktime' ";
   defaultEmbed+=" pluginspage='http://www.apple.com/quicktime/download/' ";
  
   if (embedString==""){
    embedString=defaultEmbed;
   }
   writeString+=embedString;
  
   writeString+=" /> ";
   writeString+="</object>";
   document.write(writeString);
   //alert(writeString);
}

//ѡ�񲥷���
//selectPlayer("aaa.txt");
function selectPlayer(fileUrl){
   var dotIndex;
   var fileTail="";
   var flashString=".swf.";
   var mediaString=".asf.asx.wpl.wm.wmx.wmd.wmz.wma.wax.wmv.wvx.";
   var realString=".rt.ra.rm.rmvb.rp.rv.mpg.mpeg.avi.wav.";
   var appleString=".mov.qt.mqv.";
  
   dotIndex=fileUrl.indexOf(".");
   if (dotIndex>0){
    fileTail=fileUrl.substr(dotIndex).toLowerCase();
   }
   //alert(dotIndex+"---"+fileTail);
   if (flashString.indexOf(fileTail)>=0){
    flashPlay(fileUrl,widthVal,heightValue,paramString);  
   }else if (mediaString.indexOf(fileTail)>=0){
    mediaPlay(fileUrl,widthVal,heightValue,paramString,embedString)
   }else if (realString.indexOf(fileTail)>=0){
    realPlay(fileUrl,widthVal,heightValue,paramString,embedString)
   }else if (appleString.indexOf(fileTail)>=0){
    applePlay(fileUrl,widthVal,heightValue,paramString,embedString)
   }else{
    realPlay(fileUrl,widthVal,heightValue,paramString,embedString)
   }
}
</SCRIPT>
</body>
</html>